const program = {
  start_time: 1600,
  end_time: 430,
  increment: 30, //minutes
  monday: {
    planning: [
      {
        title: {
          dutch: 'Pimp je Fiets',
          english: 'Pimp my Bike'
        },
        start: 1600,
        end: 1800,
        description: {
          dutch: 'Is jouw nieuwe (of oude) fiets ook nog zo saai en lastig herkenbaar? Geef hem wat flair met verf, stickers, googly eyes (!) en een gezonde hoeveelheid glitters. Niemand die jouw fiets nog durft te stelen, en jij hoeft je geen zorgen meer te maken dat je hem niet kan vinden in de overvolle fietsenstalling.',
          english: 'Is your new (or old) bike boring or difficult to find? Here you can pimp your bike using an assortment of awesome decorations like paint, stickers, googly eyes (!) and a healthy amount of glitter. No one will ever dare to steal your bike again and you don’t have to worry about losing it anymore.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'Kinky knopen',
          english: 'Kinky knots'
        },
        start: 1600,
        end: 1800,
        description: {
          dutch: 'Leer van schippers en maten van onze botter Trui nieuwe knopen en strikken. Te gebruiken aan boord van Trui, of voor ... andere doeleinden...',
          english: 'Learn new knots and bows from the skippers and mates or our boat Trui. Usable on board of Trui, or for ... other purposes...'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Eten @Bolk',
          english: 'Dinner @Bolk'
        },
        start: 1800,
        end: 1930,
        description: {
          dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
          english: 'Dinner with the Bolk is really good, come and have a good meal!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Weerwolven',
          english: 'Werewolves'
        },
        start: 1930,
        end: 2100,
        description: {
          dutch: 'Speel met bolkers One Night Weerwolven, een bliksemsnelle en meer interactieve versie van het orginele Weerwolven.',
          english: 'Play One Night Werewolves with us, a lightning fast and more interactive versie of the original Werewolves.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'Badeendjes vissen',
          english: 'Rubber Duck fishing'
        },
        start: 2000,
        end: 2200,
        description: {
          dutch: 'Om een BADEENDfeest te houden moeten we wel badeendjes hebben. Help ons ze op te vissen!',
          english: 'We need rubber ducks to hold a RUBBER DUCK party. Help us fish them!'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Preimeppen',
          english: 'Leek whopping'
        },
        start: 2100,
        end: 2130,
        description: {
          dutch: 'Wat zou jij doen als je tientallen kilo’s prei rond hebt slingeren? Kapot slaan tegen je medestudenten natuurlijk! Kom naar de Bolk, claim je prei en verlies een aantal vrienden in dit geweldige idee wat nooit fout kan gaan.',
          english: 'What would you do in case you have access to tens of kilos of leek? Hit your fellow students of course! Visit the Bolk, claim your leek and lose a couple of friends during this awesome idea that can’t possibly go wrong.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'BADEENDfeest',
          english: 'RUBBER DUCK party'
        },
        start: 2130,
        end: 400,
        description: {
          dutch: 'Veel BADEEND! Meer Feest! Kom dan!',
          english: 'Much RUBBER DUCK! Very Party! Be there!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: '4 uur cup-a-soup',
          english: '4 O\' Clock cup-a-soup'
        },
        start: 400,
        end: 415,
        description: {
          dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
          english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
        },
        alignment: 'center'
      }
    ]
  },

  tuesday: {
    planning: [
      {
        title: {
          dutch: 'Mega spellen',
          english: 'Mega games'
        },
        start: 1600,
        end: 1800,
        description: {
          dutch: 'Geven Vier op een rij en Jenga jou nostalgische gevoelens? Kom het spelen in het MEGA. Zorg ervoor dat je overwinning ook van een afstand te bewonderen is of daag je vrienden uit voor een rematch. Of probeer iets anders en ga spijkerslaan. Iedereen om een GROTE boomstronk, spijkers en hamers, dit kan alleen maar voor ENORM veel plezier zorgen!',
          english: 'Do Connect Four and Jenga give you nostalgic feelings? Play it in MEGA. Make sure that your victory can also be admired from a distance or challenge your friends to a rematch. Or try something different and play Nail Stump. Everyone around a BIG tree stump, nails and hammers, this can only lead to a HUGE amount of fun!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Eten @Bolk',
          english: 'Dinner @Bolk'
        },
        start: 1800,
        end: 2000,
        description: {
          dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
          english: 'Dinner with the Bolk is really good, come and have a good meal!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Mattenfort bouwen',
          english: 'Build a Mat fort'
        },
        start: 2000,
        end: 2200,
        description: {
          dutch: 'Kom lekker een fort bouwen uit de matten uit het vooronder van onze botter Trui om op uit te rusten van alle heftige activiteiten.',
          english: 'Come build a fort out of the mats from the forecastle from out boat Trui to relax from all the busy activities.'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Kijken hoe het Klinkt',
          english: 'See how it Sounds'
        },
        start: 2100,
        end: 2200,
        description: {
          dutch: 'Weet jij hoe een wasmachine klinkt als het van 4 meter valt op de grond? Kom er hier achter!',
          english: 'Do you know what sound a washing machine makes when it falls 4 meters to the ground? Come and find out here!'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'Speciaalbier proeverij',
          english: 'Craft beer tasting'
        },
        start: 2200,
        end: 2300,
        description: {
          dutch: 'Bier is er in allerlei soorten en maten. Hou je van een zoet biertje of juist eentje met een bittertje? Wil jij dat je bier zonder toevoegingen is gemaakt, of vind je het niet erg als er peper in zit? Hou je van koffie en bier? Dan kan dat ook! Het Bolksch BierbrouwersGilde kan je er van alles over vertellen tijdens deze speciaalbierproeverij!',
          english: 'Craft beers come in many shapes and sizes. Do you like a sweet or a bitter pint? Or don’t you mind if it is brewed with pepper or coffee beans? The Bolksch BierbrouwersGilde (Craft Beer Brewing Guild of the Bolk) can tell you a ton of information with every sip you take.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: '3D-Twister',
          english: '3D-Twister'
        },
        start: 2200,
        end: 2300,
        description: {
          dutch: 'Twister is een veel te simpel en comfortabel spel. Om het wat interessanter te maken voegen we een extra dimensie toe, zo garanderen we dat iedereen in de knoop raakt!',
          english: 'Twister is a far to simple and comfortable game. To make it more interesting, weĺl be adding an extra dimension. This way we can guarantee everyone gets in a bind!'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Irish Hour',
          english: 'Irish Hour'
        },
        start: 2300,
        end: 2400,
        description: {
          dutch: 'Kom Guinness drinken, we hebben het op tap.',
          english: 'Come drink Guinness, we\'ve got it on tap.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'Retro gamen',
          english: 'Retro gaming'
        },
        start: 2230,
        end: 2400,
        description: {
          dutch: 'Ken jij je klassiekers nog? Daag je vrienden uit in een potje Mario Kart, Super Smash of andere spelletjes!',
          english: 'Do you know your classics? Challenge your friends in a game of Mario Kart, Super Smash and many more games!'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Karaoke',
          english: 'Karaoke'
        },
        start: 2400,
        end: 400,
        description: {
          dutch: 'Wil jij een hele avond de leukste nummers mee blèren? Kom dan naar de karaoke en schreeuw de longen uit je lijf.',
          english: 'Do you want to sing to all your favorite songs? Then go to the karaoke and sing till your throat hurts.'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: '4 uur cup-a-soup',
          english: '4 O\' Clock cup-a-soup'
        },
        start: 400,
        end: 415,
        description: {
          dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
          english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
        },
        alignment: 'center'
      }
    ]
  },

  wednesday: {
    planning: [
      {
        title: {
          dutch: 'DnD one shot',
          english: 'DnD one shot'
        },
        start: 1600,
        end: 1900,
        description: {
          dutch: 'We hebben veel enthousiaste DM’s op de Bolk, die graag een leuke oneshot voor jullie neerzetten. Laat je met je groepje meenemen naar verre werelden en voel je vrij om op je eigen manier te roleplayen ^^',
          english: 'We\'ve got lots of enthousiastic DM\'s at the Bolk that would love to DM an oneshot for you. Come visit faraway worlds with your group and feel free to roleplay in your own way ^^.'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Eten @Bolk',
          english: 'Dinner @Bolk'
        },
        start: 1900,
        end: 2030,
        description: {
          dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
          english: 'Dinner with the Bolk is really good, come and have a good meal!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Botter Rossen',
          english: 'Botter Ross Painting'
        },
        start: 2030,
        end: 2230,
        description: {
          dutch: 'Schilder in de stijl van Bob Ross een scenisch landschap met onze botter Trui erin.',
          english: 'Paint in the style of Bob Ross a scenic landscape with our boat "Trui".'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Bierviltjesoorlog',
          english: 'Coaster War'
        },
        start: 2230,
        end: 30,
        description: {
          dutch: 'Tijdens een bierviltjesoorlog ga je met een net niet oneindige voorraad bierviltjes gooien. Gooi ze op je vrienden en/of je mentor. Alles is toegestaan in een bierviltjesoorlog. “Bierviltjes! Bierviltjes overal! Dit is chaos!” - de enige overlevende vorig jaar',
          english: 'During this event you will be able to throw a nearly unlimited supply of beer mats. Throw them at anyone.  “Beer mats, Beer mats everywhere!” - last years only survivor.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'Loco met Choco',
          english: 'Loco with Choco'
        },
        start: 2230,
        end: 2330,
        description: {
          dutch: 'Chocoladetaart, chocoladecake, chocoladekoekjes, chocoladecocktails, chocolademousse … Voor alle chocoladeliefhebbers hebben onze keukenprinsen en -prinsessen alles uit de kast gehaald om de meest chocola houdende baksels te creëren. Bestaat er iets als te veel chocola? Vind het uit!',
          english: 'Chocolate cake, chocolate biscuits, chocolate cocktails, chocolate mousse … For all chocolate lovers our kitchen princes and princesses have tried to create the most chocolate-containing pastry. Is there something like too much chocolate? Find it out!'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Blikbier Lingo',
          english: 'Beer can Lingo'
        },
        start: 30,
        end: 130,
        description: {
          dutch: 'Raad woorden en grabbel in de blikbierton om punten te verdienen. Groeeeeen!',
          english: 'Guess the words and grab something in the ton of beer cans to get points. Greeeeeeeen!'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Blikbierkwartier',
          english: 'Canned beer quarter'
        },
        start: 130,
        end: 230,
        description: {
          dutch: 'Is dit een BlikBierBorrel? Wist je dat er een auto in de soos stond? Kom zuipen ofzo.',
          english: 'Is this a CannedBeerDrink? Did you know there was a car in the soos? Come and drink or something.'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'DIY kapsalon',
          english: 'DIY kapsalon'
        },
        start: 230,
        end: 400,
        description: {
          dutch: 'Kom een kapsalon bouwen uit onze selectie van ingrediënten. Maak je kapsalon een perfecte creatie, of een vreemde combinatie van smaken die niet samen zouden moeten gaan.',
          english: 'Come and build your own kapsalon from our selection of ingredients. Make it a perfect creation, or a weird combinatie of tastes that shouldn\'t go together.'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: '4 uur cup-a-soup',
          english: '4 \'O Clock cup-a-soup'
        },
        start: 400,
        end: 415,
        description: {
          dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
          english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
        },
        alignment: 'center'
      }
    ]
  },

  thursday: {
    planning: [
      {
        title: {
          dutch: 'Spa',
          english: 'Spa'
        },
        start: 1600,
        end: 1800,
        description: {
          dutch: 'Ook zo moe van gisteren? Kom chillen met zwembadjes, gezichtscreme, gekoelde drankjes en je rustige zomerse muziek. ',
          english: 'Tired from yesterday? Come chill out at our spa with kiddie pools, face masks, cooled drinks and summery tunes.'
        },
        alignment: 'left'
      },
      {
        title: {
          dutch: 'VVThee',
          english: 'VVTea'
        },
        start: 1600,
        end: 1800,
        description: {
          dutch: 'Gezellige theeproeverij met de vereniging Vrienden Van Trui met lekkere hapjes!',
          english: 'Cosy tea tasting with the association Friends of Trui (Vrienden Van Trui) with tast treats!'
        },
        alignment: 'right'
      },
      {
        title: {
          dutch: 'Eten @Bolk',
          english: 'Dinner @Bolk'
        },
        start: 1800,
        end: 2000,
        description: {
          dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten! Schrijf je in op noms.debolk.nl',
          english: 'Dinner with the Bolk is really good, come and have a good meal! Sign up at noms.debolk.nl'
        },
        alignment: 'center'
      },
      {
        title: {
          dutch: 'Band in de soos',
          english: 'Band in the soos'
        },
        start: 2000,
        end: 2300,
        description: {
          dutch: 'De bands Headfirst en Staplers komen optreden in de soos. Dat gaat een fantastische performance worden!',
          english: 'The bands Headfirst and Staplers will be performing here. It\'ll be a fantastic performance!'
        },
        alignment: 'center'
      }
    ]
  }
}

function getTimeDif(start, end) {
  return end < start ? convertTime(end + 2400) - convertTime(start) : convertTime(end) - convertTime(start);
}

function formatTime(time) {
  time = time.toString().padStart(4, '0');
  return time.substring(0,2) + ':' + time.substring(2);
}

function convertTime(time) {
  let h = Math.floor(time/100);
  let m60 = (time % 100)/60;
  return h + m60;
}

function getHoursMinutes(increment) {
  let time_array = [];
  let start = convertTime(program.start_time);
  for (let i = 0; i <= getTimeDif(program.start_time, program.end_time) ; i += convertTime(increment)) {
    let h = start + Math.floor(i);
    let m = (i - h + start) * 60;

    if (h >= 24) h -= 24;
    time_array.push(h.toString() + ":" + m.toString().padEnd(2, '0'));
  }
  return time_array;
}

function populateDay(element, day_duration, plan) {
  for (let act of plan){
    let act_duration = getTimeDif(act.start, act.end);
    let height = act_duration / day_duration * 100;

    let act_node = document.createElement("div");
    act_node.classList.add("activity");
    act_node.classList.add(act.alignment);
    act_node.style.height = `calc(${height}% - 6px)`;

    let top = act.start >= program.start_time ?
      (convertTime(act.start) - convertTime(program.start_time))/day_duration * 100
      : (convertTime(act.start) - convertTime(program.start_time) + 24)/day_duration * 100;
    act_node.style.top = `calc(${top}%)`;

    act_node.innerHTML = "<div id='activity-content'><h2>" + act.title.dutch + "</h2><p id='duration'>" + `${formatTime(act.start)}-${formatTime(act.end)}` + "</p><p id='description'>" + act.description.dutch + "</p></div>";
    element.appendChild(act_node)
  }
  return element;
}

function resizeText(rows = -1){
  let elements = document.getElementsByClassName("activity");
  for (let element of elements){
    let maxFontSize = 30;
    if (element.clientHeight <= (element.parentElement.clientHeight/rows * 2) && element.classList.contains("center")) maxFontSize = 16;

    fitText(element, .875, {minFontSize: 10, maxFontSize: maxFontSize});
  }
}

function renderProgram() {
  let increment = convertTime(program.increment);
  let duration = getTimeDif(program.start_time, program.end_time);
  let rows = duration/increment;

  let element = document.getElementById("program");
  let node = document.createElement("table");
  let headers = document.createElement("tr");
  let col = document.createElement("col");
  col.span = 1;
  col.id = "time";

  headers.innerHTML = "<th></th><th>Maandag</th><th>Dinsdag</th><th>Woensdag</th><th>Donderdag</th>";

  node.append(headers, col);

  let day = document.createElement("td");
  day.rowSpan = rows;

  let monday = populateDay(day.cloneNode(), duration, program.monday.planning);
  let tuesday = populateDay(day.cloneNode(), duration, program.tuesday.planning);
  let wednesday = populateDay(day.cloneNode(), duration, program.wednesday.planning);
  let thursday = populateDay(day.cloneNode(), duration, program.thursday.planning);

  let hnm = getHoursMinutes(program.increment);

  for (let t of hnm){
    let row = document.createElement("tr");
    let time = document.createElement("th");
    time.innerHTML = t;
    time.id = 'time';
    if (hnm[0] === t) row.append(time, monday, tuesday, wednesday, thursday);
    else row.appendChild(time);
    node.appendChild(row);
  }

  element.appendChild(node);
  setTimeout(resizeText, 500, rows);
}
