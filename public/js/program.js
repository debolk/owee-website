const program = {
  start_time: 1600,
  end_time: 430,
  increment: 30, //minutes
  monday: [
    {
      title: {
        dutch: '(Mega) spelletjesmiddag',
        english: '(Mega) boardgames'
      },
      start: 1600,
      end: 1800,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'Eten @ Bolk',
        english: 'Dinner @ Bolk'
      },
      start: 1800,
      end: 2000,
      alignment: 'center',
      description: {
        dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
        english: 'Dinner with the Bolk is really good, come and have a good meal!'
      }
    },
    {
      title: {
        dutch: 'Weerwolven',
        english: 'Werewolves'
      },
      start: 2000,
      end: 2100,
      alignment: 'center',
      description: {
        dutch: '... van Wakkerdam: Speel met bolkers One Night Weerwolven, een bliksemsnelle en meer interactieve versie van het orginele Weerwolven',
        english: '... of Wakkerdam: Play One Night Werewolves with us, a lightning fast and more interactive versie of the original Werewolves'}
    },
    {
      title: {
        dutch: 'Preimeppen',
        english: 'Whacking with a Leek'
      },
      start: 2100,
      end: 2200,
      alignment: 'center',
      description: {
        dutch: 'Wat zou jij doen als je tientallen kilo’s prei rond hebt slingeren? Kapot slaan tegen je medestudenten natuurlijk! Kom naar de Bolk, claim je prei en verlies een aantal vrienden in dit geweldige idee wat nooit fout kan gaan',
        english: 'What would you do in case you have access to tens of kilos of leek? Hit your fellow students of course! Visit the Bolk, claim your leek and lose a couple of friends during this awesome idea that can’t possibly go wrong'
      }
    },
    {
      title: {
        dutch: 'Multifeest!',
        english: 'Multiparty!'
      },
      start: 2200,
      end: 400,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: '4 uur cup-a-soup',
        english: '4 \'O clock cup-a-soup'
      },
      start: 400,
      end: 430,
      alignment: 'center',
      description: {
        dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
        english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
      }
    }
  ],
  tuesday: [
    {
      title: {
        dutch: 'Pimp je fiets',
        english: 'Pimp your bike'
      },
      start: 1600,
      end: 1800,
      alignment: 'center',
      description: {
        dutch: 'Is jouw nieuwe (of oude) fiets ook nog zo saai en lastig herkenbaar? Geef hem wat flair met verf, stickers, googly eyes (!) en een gezonde hoeveelheid glitters. Niemand die jouw fiets nog durft te stelen, en jij hoeft je geen zorgen meer te maken dat je hem niet kan vinden in de overvolle fietsenstalling',
        english: 'Is your new (or old) bike boring or difficult to find? Here you can pimp your bike using an assortment of awesome decorations like paint, stickers, googly eyes (!) and a healthy amount of glitter. No one will ever dare to steal your bike again and you don’t have to worry about losing it anymore'
      }
    },
    {
      title: {
        dutch: 'Eten @ Bolk',
        english: 'Dinner @ Bolk'
      },
      start: 1800,
      end: 2000,
      alignment: 'center',
      description: {
        dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
        english: 'Dinner with the Bolk is really good, come and have a good meal!'
      }
    },
    {
      title: {
        dutch: 'Partygames',
        english: 'Partygames'
      },
      start: 2000,
      end: 2100,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'Kijken hoe het Klinkt',
        english: 'See how it Sounds'
      },
      start: 2100,
      end: 2200,
      alignment: 'center',
      description: {
        dutch: 'Weet jij hoe een wasmachine klinkt als het van 4 meter valt op de grond? Kom er hier achter!',
        english: 'Do you know what sound a washing machine makes when it falls 4 meters to the ground? Come and find out here!'
      }
    },
    {
      title: {
        dutch: 'Kroegsport Spelen',
        english: 'Bargames Olympics'
      },
      start: 2200,
      end: 2400,
      alignment: 'left',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'Speciaalbier proeverij',
        english: 'Tasting Craft Beer'
      },
      start: 2200,
      end: 2400,
      alignment: 'right',
      description: {
        dutch: 'Bier is er in allerlei soorten en maten. Hou je van een zoet biertje of juist eentje met een bittertje? Wil jij dat je bier zonder toevoegingen is gemaakt, of vind je het niet erg als er peper in zit? Hou je van koffie en bier? Dan kan dat ook! Het Bolksch BierbrouwersGilde kan je er van alles over vertellen tijdens deze speciaalbierproeverij!',
        english: 'Craft beers come in many shapes and sizes. Do you like a sweet or a bitter pint? Or don’t you mind if it is brewed with pepper or coffee beans? The Bolksch BierbrouwersGilde (Craft Beer Brewing Guild of the Bolk) can tell you a ton of information with every sip you take!'
      }
    },
    {
      title: {
        dutch: 'Karaoke ft. Oliebollen',
        english: 'Karoake ft. Oily Balls'
      },
      start: 2400,
      end: 300,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: '4 uur cup-a-soup',
        english: '4 \'O clock cup-a-soup'
      },
      start: 400,
      end: 430,
      alignment: 'center',
      description: {
        dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
        english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
      }
    }
  ],
  wednesday: [
    {
      title: {
        dutch: 'Maak je eigen tosti',
        english: 'Build your own tosti'
      },
      start: 1600,
      end: 1700,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'DnD Oneshot',
        english: 'DnD Oneshot'
      },
      start: 1700,
      end: 1900,
      alignment: 'center',
      description: {
        dutch: 'We hebben veel enthousiaste DM’s op de Bolk, die graag een leuke oneshot voor jullie neerzetten. Laat je met je groepje meenemen naar verre werelden en voel je vrij om op je eigen manier te roleplayen ^^',
        english: 'We\'ve got lots of enthousiastic DM\'s at the Bolk that would love to DM an oneshot for you. Come visit faraway worlds with your group and feel free to roleplay in your own way ^^'
      }
    },
    {
      title: {
        dutch: 'Eten @ Bolk',
        english: 'Dinner @ Bolk'
      },
      start: 1900,
      end: 2100,
      alignment: 'center',
      description: {
        dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten!',
        english: 'Dinner with the Bolk is really good, come and have a good meal!'
      }
    },
    {
      title: {
        dutch: 'Will it ...?',
        english: 'Will it ...?'
      },
      start: 2100,
      end: 2300,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'Dozenfort --> Bierviltjesoorlog',
        english: 'Cartboardfortress --> War \'o Coaster'
      },
      start: 2300,
      end: 2400,
      alignment: 'center',
      description: {
        dutch: 'Eerst ga je een dozenfort bouwen daarna ga je tijdens een bierviltjesoorlog ga je met een net niet oneindige voorraad bierviltjes gooien vanuit de relatieve veiligheid van je fort. Gooi ze op je vrienden en/of je mentor. Alles is toegestaan in een bierviltjesoorlog. “Bierviltjes! Bierviltjes overal! Dit is chaos!” - de enige overlevende vorig jaar',
        english: 'First you\'re building a cartboard fortress, then you will be able to throw a nearly unlimited supply of coasters from the relative safety of your fortress. Throw them at anyone.  “Beer mats, Beer mats everywhere!” - last years only survivor.'
      }
    },
    {
      title: {
        dutch: 'Kapla',
        english: 'Kapla'
      },
      start: 2400,
      end: 200,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    },
    {
      title: {
        dutch: 'BlikBierKwartier',
        english: 'Canned Beer Drive'
      },
      start: 200,
      end: 300,
      alignment: 'center',
      description: {
        dutch: 'Is dit een BlikBierBorrel? Wist je dat er een auto in de soos stond? Kom zuipen ofzo.',
        english: 'Is this a CannedBeerDrink? Did you know there was a car in the soos? Come and drink or something.'
      }
    },
    {
      title: {
        dutch: 'DIY Kapsalon',
        english: 'DIY Kapsalon'
      },
      start: 300,
      end: 400,
      alignment: 'center',
      description: {
        dutch: 'Kom een kapsalon bouwen uit onze selectie van ingrediënten. Maak je kapsalon een perfecte creatie, of een vreemde combinatie van smaken die niet samen zouden moeten gaan',
        english: 'Come and build your own kapsalon from our selection of ingredients. Make it a perfect creation, or a weird combinatie of tastes that shouldn\'t go together'
      }
    },
    {
      title: {
        dutch: '4 uur cup-a-soup',
        english: '4 \'O clock cup-a-soup'
      },
      start: 400,
      end: 430,
      alignment: 'center',
      description: {
        dutch: 'Beetje moe? Wil je je weer levend voelen, als herboren? Neem dan een 4 uur Cup-a-Soup, dat zouden meer mensen moeten doen!',
        english: 'Tired after a long night? Wanna feel alive, like you were born again? Then enjoy a nice cup-a-soup!'
      }
    }
  ],
  thursday: [
    {
      title: {
        dutch: 'Spa',
        english: 'Spa'
      },
      start: 1600,
      end: 1800,
      alignment: 'center',
      description: {
        dutch: 'Ook zo moe van gisteren? Kom chillen met zwembadjes, gezichtscreme, gekoelde drankjes en je rustige zomerse muziek',
        english: 'Tired from yesterday? Come chill out at our spa with kiddie pools, face masks, cooled drinks and summery tunes'
      }
    },
    {
      title: {
        dutch: 'Eten @ Bolk',
        english: 'Dinner @ Bolk'
      },
      start: 1800,
      end: 2000,
      alignment: 'center',
      description: {
        dutch: 'Eten bij de Bolk is echt mega lekker en gazellig, kom lekker eten! Schrijf je in op <a href="https://noms.debolk.nl">noms.debolk.nl</a>',
        english: 'Dinner with the Bolk is really good, come and have a good meal! Sign up at <a href="https://noms.debolk.nl">noms.debolk.nl</a>'
      }
    },
    {
      title: {
        dutch: 'Band op de Boot',
        english: 'Band on the Boat'
      },
      start: 2000,
      end: 2400,
      alignment: 'center',
      description: {
        dutch: '',
        english: ''
      }
    }
  ]
}

function getTimeDif(start, end) {
  return end < start
    ? convertTime(end + 2400) - convertTime(start) : convertTime(end) - convertTime(start);
}

function formatTime(time) {
  time = time.toString().padStart(4, '0');
  return time.substring(0,2) + ':' + time.substring(2);
}

function convertTime(time) {
  let h = Math.floor(time/100);
  let m60 = (time % 100)/60;
  return h + m60;
}

function getHoursMinutes(increment) {
  let time_array = [];
  let start = convertTime(program.start_time);
  for (let i = 0; i <= getTimeDif(program.start_time, program.end_time) ; i += convertTime(increment)) {
    let h = start + Math.floor(i);
    let m = (i - h + start) * 60;

    if (h >= 24) h -= 24;
    time_array.push(h.toString() + ":" + m.toString().padEnd(2, '0'));
  }
  return time_array;
}

function populateDay(element, day_duration, plan) {
  for (let act of plan){
    let act_duration = getTimeDif(act.start, act.end);
    let height = act_duration / day_duration * 100;

    let act_node = document.createElement("div");
    act_node.classList.add("activity");
    act_node.classList.add(act.alignment);
    act_node.style.height = `calc(${height}% - 6px)`;

    let top = act.start >= program.start_time ?
      (convertTime(act.start) - convertTime(program.start_time))/day_duration * 100
      : (convertTime(act.start) - convertTime(program.start_time) + 24)/day_duration * 100;
    act_node.style.top = `calc(${top}%)`;

    act_node.innerHTML = "<div id='activity-content'><h2>" + act.title.dutch + "</h2><p id='duration'>" + `${formatTime(act.start)}-${formatTime(act.end)}` + "</p><p id='description'>" + act.description.dutch + "</p></div>";
    element.appendChild(act_node)
  }
  return element;
}

function resizeText(rows = -1){
  let elements = document.getElementsByClassName("activity");
  for (let element of elements){
    let maxFontSize = 30;
    if (element.clientHeight <= (element.parentElement.clientHeight/rows * 2) && element.classList.contains("center")) maxFontSize = 16;

    fitText(element, .9, {minFontSize: 10, maxFontSize: maxFontSize});
  }
}

function renderProgram() {
  let increment = convertTime(program.increment);
  let duration = getTimeDif(program.start_time, program.end_time);
  let rows = duration/increment;

  let element = document.getElementById("program");
  let node = document.createElement("table");
  let headers = document.createElement("tr");
  let col = document.createElement("col");
  col.span = 1;
  col.id = "time";

  headers.innerHTML = "<th></th><th>Maandag</th><th>Dinsdag</th><th>Woensdag</th><th>Donderdag</th>";

  node.append(headers, col);

  let day = document.createElement("td");
  day.rowSpan = rows;

  let monday = populateDay(day.cloneNode(), duration, program.monday);
  let tuesday = populateDay(day.cloneNode(), duration, program.tuesday);
  let wednesday = populateDay(day.cloneNode(), duration, program.wednesday);
  let thursday = populateDay(day.cloneNode(), duration, program.thursday);

  let hnm = getHoursMinutes(program.increment);

  for (let t of hnm){
    let row = document.createElement("tr");
    let time = document.createElement("th");
    time.innerHTML = t;
    time.id = 'time';
    if (hnm[0] === t) row.append(time, monday, tuesday, wednesday, thursday);
    else row.appendChild(time);
    node.appendChild(row);
  }

  element.appendChild(node);
  setTimeout(resizeText, 500, rows);
}
